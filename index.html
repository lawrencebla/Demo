<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <link type="text/css" rel="stylesheet" href="css/lib/lightGallery.css" />
    <link type="text/css" rel="stylesheet" href="css/lib/CSS3Lightbox.css" />
    <link type="text/css" rel="stylesheet" href="css/lib/jquery-ui.css" />
    <link type="text/css" rel="stylesheet" href="css/global.css" />

    <link type="text/css" rel="stylesheet" href="js/widget/gallery/gallery.css" />

    <link type="text/css" rel="stylesheet" href="js/page/home/home.css" />
    <link type="text/css" rel="stylesheet" href="js/page/summary/summary.css" />
    <link type="text/css" rel="stylesheet" href="js/page/comment/comment.css" />

    <script src="js/lib/jquery-1.10.2.js"></script>
    <script src="js/lib/jquery-ui.js"></script>
    <script src="js/lib/jquery.mousewheel.min.js"></script>
	<script src="js/lib/sea-debug.js"></script>
    <script src="js/lib/underscore.js"></script>
    <script src="js/lib/backbone.js"></script>
    <script src="js/lib/json2.js"></script>
    <script src="js/lib/jquery.channel.js"></script>
    <script src="js/lib/jquery.slimscroll.js"></script>
    <script src="js/lib/lightGallery.custom.js"></script>

    <script src="js/core/class.js"></script>

    <script src="js/core/mvc/model.js"></script>
    <script src="js/core/mvc/collection.js"></script>
    <script src="js/core/mvc/view.js"></script>

    <script src="js/topic/topic_center.js"></script>
    <script src="js/config/config.js"></script>
    <script src="js/util/util.js"></script>
    <script src="js/util/url.js"></script>
    <script src="js/util/browser_adaptor.js"></script>
    <script src="js/core/ajax.js"></script>
    <script src="js/service/service.js"></script>
    <script src="js/service/cache_service.js"></script>

    <script src="js/gen/template.js"></script>

    <script src="js/core/router.js"></script>
    <script src="js/core/history.js"></script>

    <script src="js/widget/gallery/gallery.js"></script>

    <script src="js/widget/popup/general/general.js"></script>
    <script src="js/widget/popup/book/book.js"></script>

    <script src="js/page/takagism/model.js"></script>
    <script src="js/page/takagism/collection.js"></script>
    <script src="js/page/takagism/view.js"></script>
    <script src="js/page/takagism/takagism_router.js"></script>
    <script src="js/page/takagism/takagism.js"></script>

    <script src="js/page/home/model.js"></script>
    <script src="js/page/home/collection.js"></script>
    <script src="js/page/home/view.js"></script>
    <script src="js/page/home/home.js"></script>

    <script src="js/page/subject/model.js"></script>
    <script src="js/page/subject/collection.js"></script>
    <script src="js/page/subject/view.js"></script>
    <script src="js/page/subject/subject.js"></script>

    <script src="js/page/art/model.js"></script>
    <script src="js/page/art/collection.js"></script>
    <script src="js/page/art/view.js"></script>
    <script src="js/page/art/art.js"></script>

    <script src="js/page/commonweal/model.js"></script>
    <script src="js/page/commonweal/collection.js"></script>
    <script src="js/page/commonweal/view.js"></script>
    <script src="js/page/commonweal/commonweal.js"></script>

    <script src="js/page/summary/model.js"></script>
    <script src="js/page/summary/collection.js"></script>
    <script src="js/page/summary/view.js"></script>
    <script src="js/page/summary/summary.js"></script>

    <script src="js/page/comment/model.js"></script>
    <script src="js/page/comment/collection.js"></script>
    <script src="js/page/comment/view.js"></script>
    <script src="js/page/comment/comment.js"></script>

    <!-- Test Data -->
    <script src="js/test_data/home_data.js"></script>
    <script src="js/test_data/subject_data.js"></script>
    <script src="js/test_data/art_data.js"></script>
    <script src="js/test_data/commonweal_data.js"></script>
    <script src="js/test_data/comment_data.js"></script>
</head>

<body>
<div class="j-takagism-wrapper">
</div>
<script>
seajs.use(["page/takagism/takagism", "util/browser_adaptor"], function (takagism, TRANSFORM) {
    takagism.start();

    var calcTansfrom = function (scrollWrapper, itemWidth, offsetLeft) {
        scrollWrapper.css(TRANSFORM, "translate3d(" + offsetLeft / itemWidth * 100 + "%, 0%, 0px)");
    };

    $(".j-tab-content").mousewheel(function (event, delta, deltaX, deltaY) {
        var scrollWrapper = $(this).find(".j-gallery-wrapper");

        var windowWidth = $(window).width();
        var menuWidth = $(".j-menue-overlay").width() + 10;
        var currentOffsetLeft = scrollWrapper.offset().left;
        var itemWidth = scrollWrapper.width() + 20;
        var scrollWrapperWidth = scrollWrapper[0].scrollWidth;
        if (delta > 0) {
            if (currentOffsetLeft + itemWidth > menuWidth) {
                calcTansfrom(scrollWrapper, itemWidth, 0);
            } else {
                calcTansfrom(scrollWrapper, itemWidth, itemWidth, currentOffsetLeft + itemWidth - menuWidth);
            }
        } else {
            console.log(itemWidth - currentOffsetLeft);
            console.log(scrollWrapperWidth - windowWidth + menuWidth);
            if (itemWidth - currentOffsetLeft > scrollWrapperWidth - windowWidth) {
                calcTansfrom(scrollWrapper, itemWidth, windowWidth - scrollWrapperWidth - menuWidth);
            } else {
                calcTansfrom(scrollWrapper, itemWidth, currentOffsetLeft - itemWidth - menuWidth);
            }
        }
    });
});
</script>
</body>
</html>
